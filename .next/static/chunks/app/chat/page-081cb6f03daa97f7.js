(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[929],{696:function(e,t,a){Promise.resolve().then(a.bind(a,8370))},8370:function(e,t,a){"use strict";a.r(t),a.d(t,{default:function(){return M}});var s=a(7437),r=a(2265),n=a(7648),i=a(4362),o=a(6334),l=a(9756),c=a(486),d=a.n(c);let u=e=>{let t=0;if(!e||0===e.length)return{backgroundColor:"rgb(30, 30, 30)"};for(let a=0;a<e.length;a++)t=e.charCodeAt(a)+((t<<5)-t),t&=t;let a=["#412009"],s=Math.abs(t%a.length);return{backgroundColor:a[s]}},m=e=>{if(!e||""===e.trim())return"?";let t=e.trim().split(" ").filter(Boolean);return 0===t.length?"?":1===t.length?t[0].substring(0,Math.min(2,t[0].length)).toUpperCase():(t[0][0]+(t[t.length-1][0]||"")).toUpperCase()};var h=e=>{let{name:t,size:a="md",className:r=""}=e,n=m(t),i=u(t||"User"),o=d()["size".concat(a.charAt(0).toUpperCase()+a.slice(1))]||d().sizeMd;return(0,s.jsx)("div",{className:"".concat(d().avatarBase," ").concat(o," ").concat(r),style:i,title:t,children:n})},_=a(7988),g=a(4105),p=a(1069);let f=(e,t)=>{if(!e||!t)throw console.error("generateChatIdentifier: Called with missing user IDs.",{userId1:e,userId2:t}),Error("Both user IDs must be provided to generate a chat identifier.");return[e,t].sort().join("_")},C=e=>{try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))throw Error("Invalid date for separator");if((0,_.Z)(t,new Date))return"Today";if((0,g.Z)(t))return"Yesterday";return(0,p.Z)(t,"MMMM d, yyyy")}catch(e){return console.error("Error in formatDateSeparator:",e),"Date Error"}},x=e=>{try{let t="string"==typeof e?new Date(e):e;if(isNaN(t.getTime()))throw Error("Invalid date for timestamp");return(0,p.Z)(t,"p")}catch(e){return console.error("Error in formatMessageTimestamp:",e),"Time Error"}};var v=a(1469),I=a(9124),w=a.n(I);let S=e=>{let{user:t,isSelected:a,onSelectUser:r,unreadCount:n}=e;return(0,s.jsxs)("li",{onClick:()=>r(t),className:"".concat(w().userListItem," ").concat(a?w().userListItemSelected:w().userListItemUnselected),role:"button",tabIndex:0,onKeyDown:e=>{("Enter"===e.key||" "===e.key)&&r(t)},"aria-selected":a,title:"Chat with ".concat(t.name||t.username),children:[(0,s.jsx)("div",{className:w().avatarContainer,children:(0,s.jsx)(h,{name:t.name||t.username,size:"md"})}),(0,s.jsxs)("div",{className:w().userInfo,children:[(0,s.jsx)("p",{className:w().userName,children:t.name||t.username}),(0,s.jsxs)("p",{className:w().userUsername,children:["@",t.username]})]}),n>0&&(0,s.jsx)("span",{className:"".concat(w().unreadBadge," ").concat(a?w().unreadBadgeSelected:w().unreadBadgeUnselected),children:n>9?"9+":n})]})};var N=e=>{let{users:t,onSelectUser:a,selectedUserId:r,isLoading:n,initialMessage:i,unreadCounts:o,currentUserId:c}=e;return n&&0===t.length?(0,s.jsxs)("div",{className:w().spinnerContainer,children:[(0,s.jsx)(l.Z,{size:"md",className:"text-[rgb(240,186,57)]"}),(0,s.jsx)("span",{children:"Searching..."})]}):i&&0===t.length&&!n?(0,s.jsxs)("div",{className:w().listStatusContainer,children:[(0,s.jsx)(v.jRj,{className:w().listStatusIcon}),(0,s.jsx)("p",{className:w().listStatusTextLarge,children:i})]}):0!==t.length||i||n?(0,s.jsxs)("div",{className:"".concat(w().userListContainer," hide-scrollbar"),children:[" ",(0,s.jsx)("ul",{className:w().userList,children:t.map(e=>{let t=o[f(c,e._id)]||0;return(0,s.jsx)(S,{user:e,isSelected:e._id===r,onSelectUser:a,unreadCount:t},e._id)})})]}):(0,s.jsxs)("div",{className:w().listStatusContainer,children:[(0,s.jsx)(v.IC0,{className:w().listStatusIcon}),(0,s.jsx)("p",{className:w().listStatusTextLarge,children:"No users available"}),(0,s.jsx)("p",{className:w().listStatusTextSmall,children:"Try searching for someone specific."})]})},j=a(3548),b=a.n(j),L=a(2827),U=e=>{let{selectedUser:t,messages:a,onSendMessage:n,currentUserId:i,isLoadingMessages:c,hasMoreMessages:d,onLoadMoreMessages:u,onManualRefresh:m,showBackButton:g,onMobileBack:p}=e,[f,I]=(0,r.useState)(""),w=(0,r.useRef)(null),S=(0,r.useRef)(0),N=(0,r.useRef)(!0),j=(0,r.useRef)(!1);(0,r.useEffect)(()=>{let e=w.current;if(!e)return;let t=e.scrollHeight;j.current&&S.current>0&&t>S.current?(e.scrollTop=t-S.current,j.current=!1):N.current&&(e.scrollTop=t),N.current=!0,S.current=t},[a]);let U=(0,r.useRef)(null),B=(0,r.useCallback)(e=>{!c&&d&&(U.current&&U.current.disconnect(),U.current=new IntersectionObserver(e=>{if(e[0].isIntersecting&&d&&!c){var t;N.current=!1,j.current=!0,S.current=(null===(t=w.current)||void 0===t?void 0:t.scrollHeight)||0,u()}},{root:w.current,threshold:.1}),e&&U.current.observe(e))},[c,d,u]),y=e=>"sending"===e?(0,s.jsx)(v.TCC,{className:b().statusSending,title:"Sending..."}):"failed"===e?(0,s.jsx)(v.bcx,{className:b().statusFailed,title:"Failed"}):null;return t?(0,s.jsxs)("div",{className:b().chatWindowContainer,children:[(0,s.jsxs)("header",{className:b().chatHeader,children:[(0,s.jsxs)("div",{className:b().headerLeftControls,children:[g&&p&&(0,s.jsx)("button",{onClick:p,"aria-label":"Back to user list",title:"Back to user list",className:b().mobileBackButton,children:(0,s.jsx)(v.Ao2,{className:"h-5 w-5"})}),(0,s.jsxs)("div",{className:b().headerUserInfo,children:[(0,s.jsx)(h,{name:t.name||t.username,size:"md"}),(0,s.jsxs)("div",{children:[(0,s.jsx)("h2",{className:b().headerUserName,children:t.name||t.username}),(0,s.jsxs)("p",{className:b().headerUserUsername,children:["@",t.username]})]})]})]}),(0,s.jsx)("div",{className:b().headerActions,children:m&&(0,s.jsx)(o.Z,{onClick:m,variant:"ghost",size:"icon","aria-label":"Refresh chat",title:"Refresh chat",disabled:c,className:b().refreshButton,children:c&&a.length>0?(0,s.jsx)(l.Z,{size:"xs"}):(0,s.jsx)(v.Bw1,{className:"h-4 w-4"})})})]}),(0,s.jsxs)("div",{ref:w,className:b().messagesArea,children:[d&&(0,s.jsxs)("div",{ref:B,className:b().loadMoreTrigger,children:[" ",c&&(0,s.jsx)(l.Z,{size:"sm",className:"text-[rgb(240,186,57)]"})," "]}),c&&0===a.length&&(0,s.jsxs)("div",{className:b().initialLoadSpinnerContainer,children:[" ",(0,s.jsx)(l.Z,{size:"md",className:"text-[rgb(240,186,57)]"})," "]}),!c&&0===a.length&&!d&&(0,s.jsxs)("p",{className:b().noMessagesText,children:["No messages with ",t.name||t.username," yet. Say hi!"]}),a.map((e,t)=>{let n=new Date(e.timestamp),o=t>0?new Date(a[t-1].timestamp):null,l=!o||!(0,_.Z)(n,o);return(0,s.jsxs)(r.Fragment,{children:[" ",l&&(0,s.jsx)("div",{className:b().dateSeparatorContainer,children:(0,s.jsx)("span",{className:b().dateSeparatorText,children:C(n)})})," ",(0,s.jsxs)("div",{className:"".concat(b().messageRow," ").concat(e.fromUserId===i?b().messageRowSent:b().messageRowReceived," ").concat(l?b().messageRowSeparator:""),children:[" ",(0,s.jsxs)("div",{className:"".concat(b().messageBubble," ").concat(e.fromUserId===i?b().messageBubbleSent:b().messageBubbleReceived),children:[" ",(0,s.jsx)("p",{children:e.content})," ",(0,s.jsxs)("div",{className:b().messageInfo,children:[" ",e.fromUserId===i&&y(e.status)," ",(0,s.jsx)("p",{className:"".concat(b().messageTimestamp," ").concat(e.fromUserId===i?b().messageTimestampSent:b().messageTimestampReceived),children:x(n)})]})]})]})]},e.tempId||e._id||"msg-frag-".concat(t,"-").concat(n.getTime()))})]}),(0,s.jsx)("footer",{className:b().messageInputFooter,children:(0,s.jsxs)("form",{onSubmit:e=>{if(e.preventDefault(),""===f.trim()||!i)return;N.current=!0,n(f.trim()),I("");let t=e.target.elements.namedItem("messageInput");null==t||t.focus()},className:b().messageInputForm,children:[(0,s.jsx)(L.Z,{id:"messageInput",name:"messageInput",type:"text",value:f,onChange:e=>I(e.target.value),placeholder:"Message @".concat(t.username,"..."),wrapperClassName:"!mb-0 flex-grow",className:b().messageInputField,autoComplete:"off",disabled:!t||!i}),(0,s.jsxs)(o.Z,{type:"submit",variant:"primary",size:"icon",disabled:!f.trim()||!t||!i,className:b().sendButton,"aria-label":"Send message",children:[" ",(0,s.jsx)(v.LbG,{className:"h-4 w-4 sm:h-5 sm:w-5"})," "]})]})})]}):(0,s.jsxs)("div",{className:b().noUserSelectedContainer,children:[" ",(0,s.jsx)(v.EQ9,{className:b().noUserSelectedIcon})," ",(0,s.jsx)("h2",{className:b().noUserSelectedTitle,children:"Select a conversation"})," ",(0,s.jsx)("p",{className:b().noUserSelectedSubtitle,children:"Choose someone from the list to start chatting."})," "]})},B=a(3325),y=a.n(B),A=()=>{let{currentUser:e,logout:t}=(0,i.a)(),[a,n]=(0,r.useState)([]),[c,d]=(0,r.useState)([]),[u,m]=(0,r.useState)(!0),[h,_]=(0,r.useState)(null),[g,p]=(0,r.useState)(""),[C,x]=(0,r.useState)(!1),[I,w]=(0,r.useState)(null),[S,j]=(0,r.useState)("Loading recent chats..."),[b,B]=(0,r.useState)([]),[A,W]=(0,r.useState)(null),[z,M]=(0,r.useState)(!1),[k,T]=(0,r.useState)(1),[E,P]=(0,r.useState)(!0),[R,F]=(0,r.useState)({}),[Z,D]=(0,r.useState)(null),[O,H]=(0,r.useState)(!1),[X,G]=(0,r.useState)(!1);if((0,r.useEffect)(()=>{let e=()=>G(window.innerWidth<640);return e(),window.addEventListener("resize",e),()=>window.removeEventListener("resize",e)},[]),(0,r.useEffect)(()=>{X||H(!1)},[X]),!e)return(0,s.jsxs)("div",{className:"".concat(y().chatAppContainer," ").concat(y().errorFallback),children:[(0,s.jsx)(l.Z,{size:"lg"})," Critical Session Error! Please try reloading or logging in again."]});let K=(0,r.useCallback)(async function(){let t=arguments.length>0&&void 0!==arguments[0]&&arguments[0];if(e.userId){m(!0),t||""!==g?t&&j("Refreshing user list..."):j("Loading recent chats...");try{let a=await fetch("/api/conversations",{headers:{"X-Current-User-Id":e.userId}}),s=await a.json();s.success&&s.users?(d(s.users),(""===g.trim()||t)&&n(s.users),0===s.users.length&&(""===g.trim()||t)?j("No recent chats. Search for users to start a conversation."):(""===g.trim()||t)&&j(null)):(""===g.trim()||t)&&j("Could not load recent chats.")}catch(e){(""===g.trim()||t)&&j("Error loading recents.")}finally{m(!1)}}},[e.userId,g]);(0,r.useEffect)(()=>{e.userId&&K(!1)},[e.userId,K]);let Y=(0,r.useCallback)(async()=>{if(e.userId){if(g.trim().length<2){w("Please enter at least 2 characters."),j("Min. 2 chars."),n(c);return}j(null),x(!0),w(null),n([]);try{let t=await fetch("/api/users/search?q=".concat(encodeURIComponent(g.trim())),{headers:{"X-Current-User-Id":e.userId}}),a=await t.json();t.ok&&a.success?(n(a.users),0===a.users.length&&j("No users found matching search.")):w(a.message||"Search failed.")}catch(e){console.error("Search API error:",e),w("Search connection error.")}finally{x(!1)}}},[e.userId,g,c]),J=(0,r.useCallback)(e=>{e&&e.preventDefault(),""===g.trim()?K(!0):Y()},[Y,g,K]);(0,r.useEffect)(()=>{""!==g.trim()||C||u?g.trim().length>0&&g.trim().length<2&&j("Keep typing (min 2 chars)..."):(n(c),0!==c.length||u?j(null):j("No recent chats. Search for users to start a conversation."))},[g,c,C,u]);let Q=(0,r.useCallback)(async function(t,a){let s=arguments.length>2&&void 0!==arguments[2]&&arguments[2],r=arguments.length>3&&void 0!==arguments[3]&&arguments[3];if(!e.userId){console.error("fetchChatMessages: User ID missing.");return}if((s||r||!z||1!==a)&&(!s||E&&!z)){console.log("ChatAppInterface: Fetching messages. Collection: ".concat(t,", Page: ").concat(a,", LoadMore: ").concat(s,", ManualRefresh: ").concat(r)),M(!0);try{let r=await fetch("/api/messages/".concat(t,"?page=").concat(a,"&limit=").concat(30),{headers:{"X-Current-User-Id":e.userId}}),n=await r.json();if(n.success){let e=n.messages.map(e=>({_id:e._id,content:e.content,timestamp:new Date(e.timestamp),fromUserId:e.fromUserId,fromUsername:e.fromUsername,status:"sent",chatId:t,toUserId:(null==h?void 0:h._id)||""}));B(t=>{let a=s?[...e.reverse(),...t]:e.reverse(),r=new Map(a.map(e=>[e._id||e.tempId,e]));return Array.from(r.values()).sort((e,t)=>new Date(e.timestamp).getTime()-new Date(t.timestamp).getTime())}),P(n.currentPage<n.totalPages),s||T(1)}else D(n.message||"Could not load messages.")}catch(e){D("Error fetching messages.")}finally{M(!1),Z&&setTimeout(()=>D(null),3e3)}}},[e.userId,h,Z]);(0,r.useEffect)(()=>{A&&e.userId&&(B([]),T(1),P(!0),Q(A,1,!1,!1))},[A,e.userId,Q]);let V=(0,r.useCallback)(()=>{K(!0),A&&e.userId&&!z&&Q(A,1,!1)},[K,A,e.userId,z,Q]);(0,r.useEffect)(()=>{let e=setInterval(()=>{V()},3e3);return()=>{clearInterval(e)}},[V]);let q=(0,r.useCallback)(async t=>{if(!h||!A||!e.userId||!e.username){D("Cannot send.");return}let a="temp-".concat(Date.now(),"-").concat(Math.random().toString(36).substr(2,9)),s={tempId:a,chatId:A,fromUserId:e.userId,fromUsername:e.username,toUserId:h._id,content:t,timestamp:new Date,status:"sending"};B(e=>[...e,s]);try{let s=await fetch("/api/messages/send",{method:"POST",headers:{"Content-Type":"application/json","X-User-Id":e.userId,"X-Username":e.username},body:JSON.stringify({toUserId:h._id,content:t,chatId:A,tempId:a,fromUserId:e.userId,fromUsername:e.username})}),r=await s.json();if(r.success&&r.message){let e={...r.message,timestamp:new Date(r.message.timestamp),status:"sent"};B(t=>t.map(t=>t.tempId===a?e:t)),A&&Q(A,1,!1,!0)}else B(e=>e.map(e=>e.tempId===a?{...e,status:"failed"}:e)),D("Failed to send.")}catch(e){B(e=>e.map(e=>e.tempId===a?{...e,status:"failed"}:e)),D("Error sending msg.")}finally{Z&&setTimeout(()=>D(null),3e3)}},[h,A,e.userId,e.username,Q,Z]),$=(0,r.useCallback)(a=>{if(!e.userId){t();return}if((null==h?void 0:h._id)===a._id&&A){X&&H(!0);return}_(a);let s=f(e.userId,a._id);W(s),document.title="".concat(a.name," - Buzzly Minimal"),s&&F(e=>({...e,[s]:0})),X&&H(!0)},[e.userId,h,A,t,X]);return(0,r.useEffect)(()=>{let e=()=>{document.title.includes("New Message")&&A&&(F(e=>({...e,[A]:0})),document.title=h?"".concat(h.name," - Buzzly Minimal"):"Buzzly Minimal")};return window.addEventListener("focus",e),()=>window.removeEventListener("focus",e)},[h,A]),(0,r.useEffect)(()=>{if(h&&e.userId){let e=A&&R[A]||0;e>0&&document.hidden?document.title="(".concat(e,") ").concat(h.name," - Buzzly Minimal"):document.title="".concat(h.name," - Buzzly Minimal")}else document.title.includes("New Message")&&!document.hidden?document.title="Buzzly Minimal":h||document.title.includes("New Message")||(document.title="Buzzly Minimal Chat")},[h,R,A,e.userId]),(0,s.jsxs)("div",{className:"".concat(y().chatAppContainer," ").concat(X&&O?y().mobileChatViewActive:""),children:[(0,s.jsxs)("aside",{className:y().sidebar,children:[(0,s.jsx)("div",{className:y().Navbar,children:(0,s.jsx)("img",{src:"/logo.png",width:"100px"})}),Z&&(0,s.jsx)("div",{className:y().sidebarGeneralError,children:Z}),(0,s.jsxs)("form",{onSubmit:J,className:y().searchForm,children:[(0,s.jsx)(L.Z,{type:"text",placeholder:"Search users...",value:g,onChange:e=>p(e.target.value),wrapperClassName:y().searchInputWrapper,className:y().searchInput,"aria-label":"Search users input"}),(0,s.jsx)(o.Z,{type:"submit",variant:"secondary",size:"md",isLoading:C,disabled:C||g.trim().length<2,"aria-label":"Search users button",className:y().searchButton,children:C?(0,s.jsx)(l.Z,{size:"xs"}):(0,s.jsx)(v.jRj,{})})]}),I&&(0,s.jsx)("p",{className:y().searchError,children:I}),(0,s.jsx)(N,{users:a,onSelectUser:$,selectedUserId:null==h?void 0:h._id,isLoading:(C||u)&&0===a.length,initialMessage:S,unreadCounts:R,currentUserId:e.userId}),(0,s.jsxs)("div",{className:y().logoutSection,children:[" ",(0,s.jsx)(o.Z,{onClick:t,variant:"danger",fullWidth:!0,className:y().logoutButton,children:"Log Out"})," "]})]}),(0,s.jsx)("section",{className:y().chatArea,children:(0,s.jsx)(U,{selectedUser:h,messages:b,onSendMessage:q,currentUserId:e.userId,isLoadingMessages:z,hasMoreMessages:E,onLoadMoreMessages:()=>{E&&!z&&A&&Q(A,k+1,!0)},onManualRefresh:V,showBackButton:X&&!!h,onMobileBack:()=>H(!1)})})]})},W=a(9015),z=a.n(W);function M(){let{currentUser:e,login:t,isLoadingAuth:a}=(0,i.a)(),[c,d]=(0,r.useState)(!1),[u,m]=(0,r.useState)(null),[h,_]=(0,r.useState)(""),[g,p]=(0,r.useState)(""),f=async e=>{e.preventDefault(),d(!0),m(null);try{let e=await fetch("/api/auth/login",{method:"POST",headers:{"Content-Type":"application/json"},body:JSON.stringify({emailOrUsername:h,password:g})}),a=await e.json();e.ok&&a.success&&a.user?t(a.user):m(a.message||"Login failed.")}catch(e){m("Login error.")}finally{d(!1)}};(0,r.useEffect)(()=>{console.log("ChatPage: Auth state. isLoadingAuth:",a,"currentUser:",null==e?void 0:e.username)},[e,a]);let C="Initializing...";return(a?C="":e||(C="Please login"),a)?(0,s.jsxs)("div",{className:z().pageLoaderContainer,children:[(0,s.jsx)(l.Z,{size:"lg",className:"text-[rgb(240,186,57)]"}),(0,s.jsx)("p",{className:"ml-4 mt-3 text-sm",children:C})]}):e?(0,s.jsx)(A,{}):(0,s.jsxs)("div",{className:z().loginPageContainer,children:[(0,s.jsxs)("div",{className:z().loginFormWrapper,children:[(0,s.jsxs)("div",{className:z().logoContainer,children:[(0,s.jsx)("img",{src:"/logo.png"}),(0,s.jsx)("p",{className:z().tagline,children:"Minimalist Chat"})]}),(0,s.jsxs)("form",{onSubmit:f,className:z().loginForm,children:[u&&(0,s.jsx)("p",{className:z().errorMessage,children:u}),(0,s.jsx)(L.Z,{label:"Email or Username",id:"mainLoginEmailOrUsername",type:"text",value:h,onChange:e=>_(e.target.value),required:!0,placeholder:"username or email",disabled:c,autoComplete:"username",wrapperClassName:"!mb-0"}),(0,s.jsx)(L.Z,{label:"Password",id:"mainLoginPassword",type:"password",value:g,onChange:e=>p(e.target.value),required:!0,placeholder:"••••••••",disabled:c,autoComplete:"current-password",wrapperClassName:"!mb-0"}),(0,s.jsx)("div",{style:{paddingTop:"0.5rem"},children:(0,s.jsx)(o.Z,{type:"submit",fullWidth:!0,className:z().authButton,isLoading:c,disabled:c,variant:"primary",children:c?"":"Log In"})}),(0,s.jsxs)("p",{className:z().signupPrompt,children:["No account?"," ",(0,s.jsx)(n.default,{href:"/signup",className:z().formLink,children:"Create one"})]})]})]}),(0,s.jsxs)("p",{className:z().footerText,children:["\xa9 ",new Date().getFullYear()," Buzzly Minimal"]})]})}},6334:function(e,t,a){"use strict";var s=a(7437);a(2265);var r=a(9756),n=a(424),i=a.n(n);t.Z=e=>{let{children:t,className:a,variant:n="primary",size:o="md",isLoading:l=!1,fullWidth:c=!1,disabled:d,leftIcon:u,rightIcon:m,...h}=e,_=i()["variant".concat(n.charAt(0).toUpperCase()+n.slice(1))],g=i()["size".concat(o.toUpperCase())]||i().sizeMd,p=c?i().fullWidth:"",f="text-[rgb(240,186,57)]";return("primary"===n||"danger"===n)&&(f="text-white"),(0,s.jsxs)("button",{className:"".concat(i().buttonBase," ").concat(_," ").concat(g," ").concat(p," ").concat(a||""),disabled:d||l,...h,children:[l&&(0,s.jsx)(r.Z,{size:"sm",className:"".concat(i().spinnerLoading," ").concat(f)}),!l&&u&&(0,s.jsx)("span",{className:"".concat(i().iconLeft," ").concat("sm"===o?i().iconSm:i().iconMd),children:u}),(0,s.jsx)("span",{className:l&&t?i().textHiddenWhileLoading:"",children:t}),!l&&m&&(0,s.jsx)("span",{className:"".concat(i().iconRight," ").concat("sm"===o?i().iconSm:i().iconMd),children:m}),l&&t&&(0,s.jsx)("span",{className:i().textAbsoluteForLoading,children:t})]})}},2827:function(e,t,a){"use strict";var s=a(7437);a(2265);var r=a(3300),n=a.n(r);t.Z=e=>{let{label:t,id:a,error:r,wrapperClassName:i,className:o,...l}=e,c=a||l.name||"input-".concat(Math.random().toString(36).substring(2,9));return(0,s.jsxs)("div",{className:"".concat(n().inputWrapper," ").concat(i||""),children:[t&&(0,s.jsx)("label",{htmlFor:c,className:n().label,children:t}),(0,s.jsx)("input",{id:c,className:"\n          ".concat(n().inputElement,"\n          ").concat(r?n().inputElementError:"","\n          ").concat(o||"","\n        "),...l}),r&&(0,s.jsx)("p",{className:n().errorMessage,children:r})]})}},9756:function(e,t,a){"use strict";var s=a(7437);a(2265),t.Z=e=>{let{size:t="md",color:a,className:r="",ariaLabel:n="Loading content"}=e,i="20px";switch(t){case"xs":i="12px";break;case"sm":i="16px";break;case"lg":i="32px";break;case"xl":i="48px"}let o={height:i,width:i,color:a||"rgb(240,186,57)"};return(0,s.jsxs)("svg",{className:"animate-spin ".concat(r),style:o,xmlns:"http://www.w3.org/2000/svg",fill:"none",viewBox:"0 0 24 24","aria-label":n,role:"status",children:[(0,s.jsx)("circle",{className:"opacity-25",cx:"12",cy:"12",r:"10",stroke:"currentColor",strokeWidth:"4",style:{opacity:.25}}),(0,s.jsx)("path",{className:"opacity-75",fill:"currentColor",d:"M4 12a8 8 0 018-8V0C5.373 0 0 5.373 0 12h4zm2 5.291A7.962 7.962 0 014 12H0c0 3.042 1.135 5.824 3 7.938l3-2.647z",style:{opacity:.75}})]})}},4362:function(e,t,a){"use strict";a.d(t,{AuthProvider:function(){return l},a:function(){return o}});var s=a(7437),r=a(2265),n=a(9376);let i=(0,r.createContext)(void 0),o=()=>{let e=(0,r.useContext)(i);if(void 0===e)throw Error("useAuth must be used within an AuthProvider");return e},l=e=>{let{children:t}=e,[a,o]=(0,r.useState)(null),[l,c]=(0,r.useState)(!1),d=(0,n.useRouter)(),u=(0,r.useCallback)(e=>{console.log("[AuthContext] Login: Setting currentUser -",e.username),o({...e,createdAt:"string"==typeof e.createdAt?new Date(e.createdAt):e.createdAt})},[]),m=(0,r.useCallback)(async()=>{console.log("[AuthContext] Logout: Clearing currentUser"),o(null);try{await fetch("/api/auth/logout",{method:"POST"})}catch(e){console.error("[AuthContext] Logout API call failed:",e)}d.push("/chat")},[d]);return(0,s.jsx)(i.Provider,{value:{currentUser:a,isLoadingAuth:l,login:u,logout:m},children:t})}},9015:function(e){e.exports={pageLoaderContainer:"ChatPageContainer_pageLoaderContainer__Jwjwk",loginPageContainer:"ChatPageContainer_loginPageContainer__otyDP",loginFormWrapper:"ChatPageContainer_loginFormWrapper__Qz0hM",logoContainer:"ChatPageContainer_logoContainer__A8v_8",logoLink:"ChatPageContainer_logoLink__qt2eh",tagline:"ChatPageContainer_tagline__SZz7h",loginForm:"ChatPageContainer_loginForm__opPtf",errorMessage:"ChatPageContainer_errorMessage__WzYdv",signupPrompt:"ChatPageContainer_signupPrompt__NZM_7",signupLink:"ChatPageContainer_signupLink__ONYtm",footerText:"ChatPageContainer_footerText__1xm9A",buttonLogin:"ChatPageContainer_buttonLogin__UrOfL"}},3325:function(e){e.exports={chatAppContainer:"ChatAppInterface_chatAppContainer__xRXp9",sidebar:"ChatAppInterface_sidebar__NjtRH",chatArea:"ChatAppInterface_chatArea__CqAZr",mobileChatViewActive:"ChatAppInterface_mobileChatViewActive__7oZoQ",errorFallback:"ChatAppInterface_errorFallback__h_bw0",sidebarGeneralError:"ChatAppInterface_sidebarGeneralError__oPNNc",socketStatusContainer:"ChatAppInterface_socketStatusContainer__GF9Bt",socketStatusText:"ChatAppInterface_socketStatusText__WDIaj",statusOnline:"ChatAppInterface_statusOnline__vnhQX",statusOffline:"ChatAppInterface_statusOffline__fGTUe",searchForm:"ChatAppInterface_searchForm__37Qzq",searchInputWrapper:"ChatAppInterface_searchInputWrapper__jBKLb",searchInput:"ChatAppInterface_searchInput__CQaXT",searchButton:"ChatAppInterface_searchButton__cilRW",searchError:"ChatAppInterface_searchError__ruhOF",logoutSection:"ChatAppInterface_logoutSection__Jr7i5",logoutButton:"ChatAppInterface_logoutButton__z_Vcd",Navbar:"ChatAppInterface_Navbar__ZO2RK"}},3548:function(e){e.exports={chatWindowContainer:"ChatWindow_chatWindowContainer__5xZ6e",chatHeader:"ChatWindow_chatHeader__l192N",headerUserInfo:"ChatWindow_headerUserInfo__zLWcj",headerUserName:"ChatWindow_headerUserName__6xOur",headerLeftControls:"ChatWindow_headerLeftControls__zN_Za",headerUserUsername:"ChatWindow_headerUserUsername__iZAKn",headerActions:"ChatWindow_headerActions__YSNSL",refreshButton:"ChatWindow_refreshButton__1wAFH",messagesArea:"ChatWindow_messagesArea__kPswG",loadMoreTrigger:"ChatWindow_loadMoreTrigger__Lqp7H",initialLoadSpinnerContainer:"ChatWindow_initialLoadSpinnerContainer__tsBYp",noMessagesText:"ChatWindow_noMessagesText__JA2VY",dateSeparatorContainer:"ChatWindow_dateSeparatorContainer__BW_0_",dateSeparatorText:"ChatWindow_dateSeparatorText__gOIb9",messageRow:"ChatWindow_messageRow__6znGR",messageRowGrouped:"ChatWindow_messageRowGrouped__stJU2",messageRowSent:"ChatWindow_messageRowSent__mwkHz",messageRowReceived:"ChatWindow_messageRowReceived__zlEcS",messageRowSeparator:"ChatWindow_messageRowSeparator__5Q798",messageBubble:"ChatWindow_messageBubble__K8YEs",messageBubbleSent:"ChatWindow_messageBubbleSent__zbkAm",messageBubbleReceived:"ChatWindow_messageBubbleReceived__YVDB5",messageInfo:"ChatWindow_messageInfo__aPmIB",messageTimestamp:"ChatWindow_messageTimestamp__Vp5hk",messageTimestampSent:"ChatWindow_messageTimestampSent__k7ZQ8",messageTimestampReceived:"ChatWindow_messageTimestampReceived__rhXpc",statusSending:"ChatWindow_statusSending__b78h8",statusFailed:"ChatWindow_statusFailed__Eb9v8",messageInputFooter:"ChatWindow_messageInputFooter__afTgi",messageInputForm:"ChatWindow_messageInputForm__p8RNe",messageInputField:"ChatWindow_messageInputField__iaWnL",sendButton:"ChatWindow_sendButton__93HtE",noUserSelectedContainer:"ChatWindow_noUserSelectedContainer__hSLfg",noUserSelectedIcon:"ChatWindow_noUserSelectedIcon__JJQPo",noUserSelectedTitle:"ChatWindow_noUserSelectedTitle__FJIWe",noUserSelectedSubtitle:"ChatWindow_noUserSelectedSubtitle___EDXr"}},9124:function(e){e.exports={userListContainer:"UserList_userListContainer__TgGhv",userList:"UserList_userList__QVWf7",userListItem:"UserList_userListItem__5SPcS",userListItemUnselected:"UserList_userListItemUnselected__kroUO",userListItemSelected:"UserList_userListItemSelected__f3vrh",avatarContainer:"UserList_avatarContainer__tLqWZ",userInfo:"UserList_userInfo__KYWM_",userName:"UserList_userName__HeGX0",userUsername:"UserList_userUsername__juplr",unreadBadge:"UserList_unreadBadge__i7wRy",unreadBadgeSelected:"UserList_unreadBadgeSelected__CC7kw",unreadBadgeUnselected:"UserList_unreadBadgeUnselected__6507K",listStatusContainer:"UserList_listStatusContainer__IKjmK",listStatusIcon:"UserList_listStatusIcon__RtAoi",listStatusTextLarge:"UserList_listStatusTextLarge__Fz6xg",listStatusTextSmall:"UserList_listStatusTextSmall__BByMb",spinnerContainer:"UserList_spinnerContainer__WhJFf"}},486:function(e){e.exports={avatarBase:"AvatarPlaceholder_avatarBase__lcreW",sizeXs:"AvatarPlaceholder_sizeXs__wYv60",sizeSm:"AvatarPlaceholder_sizeSm__Of2pn",sizeMd:"AvatarPlaceholder_sizeMd__umfwf",sizeLg:"AvatarPlaceholder_sizeLg__w601C",sizeXl:"AvatarPlaceholder_sizeXl__x4hbZ"}},424:function(e){e.exports={buttonBase:"Button_buttonBase__5Nbp_",sizeSm:"Button_sizeSm__Qakl3",sizeMd:"Button_sizeMd__VN8NK",sizeLg:"Button_sizeLg__4lRag",sizeIcon:"Button_sizeIcon__VjLki",variantPrimary:"Button_variantPrimary__gS6mT",variantSecondary:"Button_variantSecondary__pZIyO",variantGhost:"Button_variantGhost__N3Fjl",variantLink:"Button_variantLink__9rDhX",variantDanger:"Button_variantDanger__PoCK4",fullWidth:"Button_fullWidth__JjsBk",iconLeft:"Button_iconLeft__HEYpQ",iconRight:"Button_iconRight__CZFfJ",iconSm:"Button_iconSm__bivUw",iconMd:"Button_iconMd__sdPUl",spinnerLoading:"Button_spinnerLoading__9UqUo",textHiddenWhileLoading:"Button_textHiddenWhileLoading__1_sKG",textAbsoluteForLoading:"Button_textAbsoluteForLoading__4v7v_"}},3300:function(e){e.exports={inputWrapper:"Input_inputWrapper__BtixV",label:"Input_label__83Pis",inputElement:"Input_inputElement__CvUnf",inputElementError:"Input_inputElementError__YoKi6",errorMessage:"Input_errorMessage__e98gW"}}},function(e){e.O(0,[282,885,502,448,892,971,117,744],function(){return e(e.s=696)}),_N_E=e.O()}]);